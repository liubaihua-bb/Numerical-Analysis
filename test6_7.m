fun = @(x) 4./(1+x.^2);
x0=0;
x1_16=1/16;
x1_8=1/8;
x3_16=3/16;
x1_4=0.25;
x5_16=5/16;
x3_8=3/8;
x7_16=7/16;
x1_2=0.5;
x9_16=9/16;
x5_8=5/8;
x11_16=11/16;
x3_4=0.75;
x13_16=13/16;
x7_8=7/8;
x15_16=15/16;
x1=1;

R=zeros(5);
R(1,1)=1/2*(fun(x0)+fun(x1));
R(2,1)=1/4*(fun(x0)+2*fun(x1_2)+fun(x1));
R(3,1)=1/8*(fun(x0)+2*(fun(x1_4)+fun(x1_2)+fun(x3_4))+fun(x1));
R(4,1)=1/16*(fun(x0)+2*(fun(x1_8)+fun(x1_4)+fun(x3_8)+fun(x1_2)+fun(x5_8)+fun(x3_4)+fun(x7_8))+fun(x1));
R(5,1)=1/32*(fun(x0)+2*(fun(x1_16)+fun(x1_8)+fun(x3_16)+fun(x1_4)+fun(x5_16)+fun(x3_8)+fun(x7_16)+fun(x1_2)+fun(x9_16)+fun(x5_8)+fun(x11_16)+fun(x3_4)+fun(x13_16)+fun(x7_8)+fun(x15_16))+fun(x1));

R(2,2)=(4*R(2,1)-R(1,1))/3;
R(3,2)=(4*R(3,1)-R(2,1))/3;
R(4,2)=(4*R(4,1)-R(3,1))/3;
R(5,2)=(4*R(5,1)-R(4,1))/3;


R(3,3)=(16*R(3,2)-R(2,2))/15;
R(4,3)=(16*R(4,2)-R(3,2))/15;
R(5,3)=(16*R(5,2)-R(4,2))/15;

R(4,4)=(64*R(4,3)-R(3,3))/63;
R(5,4)=(64*R(5,3)-R(4,3))/63;

R(5,5)=(256*R(5,4)-R(4,4))/255;